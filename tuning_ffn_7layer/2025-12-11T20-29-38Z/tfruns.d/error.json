{
  "message": "tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:\n\n<...truncated...>WC14xssaB_ks6xuAK/lib/python3.12/site-packages/keras/src/metrics/metrics_utils.py\", line 484, in update_confusion_matrix_variables\n\n  File \"/home/rstudio/.cache/R/reticulate/uv/cache/archive-v0/2Mm2WC14xssaB_ks6xuAK/lib/python3.12/site-packages/keras/src/metrics/metrics_utils.py\", line 280, in _update_confusion_matrix_variables_optimized\n\n  File \"/home/rstudio/.cache/R/reticulate/uv/cache/archive-v0/2Mm2WC14xssaB_ks6xuAK/lib/python3.12/site-packages/keras/src/ops/math.py\", line 86, in segment_sum\n\n  File \"/home/rstudio/.cache/R/reticulate/uv/cache/archive-v0/2Mm2WC14xssaB_ks6xuAK/lib/python3.12/site-packages/keras/src/backend/tensorflow/math.py\", line 23, in segment_sum\n\ndata.shape = [256] does not start with segment_ids.shape = [2048]\n\t [[{{node UnsortedSegmentSum_1}}]] [Op:__inference_multi_step_on_iterator_15495287]\nRun `reticulate::py_last_error()` for details.",
  "traceback": ["py_call_impl(callable, call_args$unnamed, call_args$named)", "(structure(function (x = NULL, y = NULL, batch_size = NULL, epochs = 1L, \n    verbose = \"auto\", callbacks = NULL, validation_split = 0, \n    validation_data = NULL, shuffle = TRUE, class_weight = NULL, \n    sample_weight = NULL, initial_epoch = 0L, steps_per_epoch = NULL, \n    validation_steps = NULL, validation_batch_size = NULL, validation_freq = 1L) \n{\n    cl <- sys.call()\n    cl[[1L]] <- list2\n    call_args <- split_named_unnamed(eval(cl, parent.frame()))\n    result <- py_call_impl(callable, call_args$unnamed, call_args$named)\n    if (py_get_convert(callable)) \n        result <- py_to_r(result)\n    if (is.null(result)) \n        invisible(result)\n    else result\n}, class = c(\"python.builtin.method\", \"python.builtin.object\"\n), py_object = <environment>))(x = list(income_in = <environment>, \n    educ_in = <environment>, family_in = <environment>, housing_in = <environment>, \n    occupation_in = <environment>, numeric_in = <environment>, \n    binary_in = <environment>), y = <environment>, batch_size = 256L, \n    epochs = 2000L, callbacks = list(<environment>, <environment>, \n        <environment>, <environment>, <environment>, <environment>), \n    validation_data = list(list(income_in = <environment>, educ_in = <environment>, \n        family_in = <environment>, housing_in = <environment>, \n        occupation_in = <environment>, numeric_in = <environment>, \n        binary_in = <environment>), <environment>), class_weight = <environment>, \n    verbose = 2L)", "do.call(object$fit, args)", "fit.keras.src.models.model.Model(., x = train_inputs, y = y_train, \n    validation_data = list(val_inputs, y_val), epochs = FLAGS$epochs, \n    batch_size = FLAGS$batch_size, callbacks = list(callback_warmup, \n        callback_es, callback_lr, callback_cp), class_weight = class_weights, \n    verbose = 2)", "fit(., x = train_inputs, y = y_train, validation_data = list(val_inputs, \n    y_val), epochs = FLAGS$epochs, batch_size = FLAGS$batch_size, \n    callbacks = list(callback_warmup, callback_es, callback_lr, \n        callback_cp), class_weight = class_weights, verbose = 2)", "model_ffn %>% fit(x = train_inputs, y = y_train, validation_data = list(val_inputs, \n    y_val), epochs = FLAGS$epochs, batch_size = FLAGS$batch_size, \n    callbacks = list(callback_warmup, callback_es, callback_lr, \n        callback_cp), class_weight = class_weights, verbose = 2)", "eval(ei, envir)", "eval(ei, envir)", "withVisible(eval(ei, envir))", "tuning_run(\"nn_experiment.R\", runs_dir = \"tuning_ffn_7layer\", \n    sample = 1, flags = list(learning_rate = c(5e-04, 0.001), \n        batch_size = c(256), width_factor = c(0.75, 1), act = c(\"gelu\", \n            \"elu\"), drop = c(0.1, 0.2, 0.3), epochs = 2000))"]
}
